(this.webpackJsonpColosseumUI=this.webpackJsonpColosseumUI||[]).push([[0],{65:function(e,t,n){},67:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(19),s=n.n(i),o=(n(65),n(9)),c=n(14),u=n(11),l=n(10),h=n(7),d=n.n(h),m=n(96),b=n(102),v=(n(67),n(39)),f=n(60),p=n(55),j=n.n(p),O=n(17),x=n(101),g=n(95),N=n(97),w=n(58),k=n(59),y=n(98),L=n(103),S=n(35),C=n(13),F=n.n(C),E=n(23),T=n(56),I=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new Promise((function(e,r){setTimeout((function(){return r(n||"Timed out in ".concat(t," ms."))}),t)}));return Promise.race([e,r])}var V={baudRate:2e6,dataBits:8,stopBits:1,parity:"none",bufferSize:255,flowControl:"none"},P={usbVendorId:9025},D=5e3,U="<Arduino is ready>",A=["<SET_ACCEL,111,1000.0,1000.0,1000.0>","<SET_SPEED,111,1000.0,1000.0,1000.0>"],W=[84,78,75,70,64,61,58,56,54,52,50,48,47,46,45,44,43,42,41,40,39,39,38,37,36,36,35,34,34,34,33,33,32,32,31,31,31,30,30,30,29,29,29,28,28,28,27,27,27,26,26,26,26,26,25,25,25,25,24,24,24,24,24,24,23,23,23,23,23,23,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,20,20],M=/[^<>,]+/g;function z(e,t){return e.match(M)[0]===t.match(M)[0]}var B=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(o.a)(this,e),this.connect=function(){return R(t._connect(),D,"Connection timed out.")},this.disconnect=function(){return R(t._disconnect(),D,"Disconnection timed out.")},this.send=function(e){return R(t._send(e),D,"Command ".concat(e," timed out."))},this.dry=n,this.serial=new T.BrowserSerial(V,P),this.reader=this.serial.readLineGenerator(),this.connected=n,this.ready=!1,this.paused=!1,this.stopped=!1,this.done=!1,this.error=!1,this.startTime=null,this.position=0,this.numberOfFractions=null,this.interval=null,this.callback=null,this.doneCallback=null,this.errorCallback=null}return Object(c.a)(e,[{key:"_connect",value:function(){var e=Object(E.a)(F.a.mark((function e(){var t,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dry){e.next=2;break}return e.abrupt("return",U);case 2:return e.next=4,this.serial.connect();case 4:return e.next=6,this.reader.next();case 6:if(t=e.sent,(n=t.value.value)===U){e.next=10;break}throw Error("Unexpected response ".concat(n,". Expected ").concat(U,".\n      Is the Arduino flashed with the correct firmware?"));case 10:return this.connected=!0,e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_disconnect",value:function(){var e=Object(E.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dry){e.next=2;break}return e.abrupt("return");case 2:if(this.connected){e.next=4;break}throw Error("No device connected.");case 4:return e.next=6,this.serial.disconnect();case 6:this.connected=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_send",value:function(){var e=Object(E.a)(F.a.mark((function e(t){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dry){e.next=2;break}return e.abrupt("return",t);case 2:if(this.connected){e.next=4;break}throw Error("No device connected.");case 4:return e.next=6,this.serial.write(t);case 6:return e.next=8,this.reader.next();case 8:return n=e.sent,e.abrupt("return",n.value.value);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendAndVerify",value:function(){var e=Object(E.a)(F.a.mark((function e(t){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send(t);case 2:if(n=e.sent,z(t,n)){e.next=5;break}throw Error("Unexpected response ".concat(n,". Expected ").concat(t,"."));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setup",value:function(){var e=Object(E.a)(F.a.mark((function e(t,n){var r,a,i,s,o,c,u=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:function(){return null},a=u.length>3&&void 0!==u[3]?u[3]:function(){return null},i=u.length>4&&void 0!==u[4]?u[4]:function(){return null},this.connected){e.next=5;break}throw Error("No device connected.");case 5:this.interval=n,this.numberOfFractions=t,this.callback=r,this.doneCallback=i,this.errorCallback=a,s=Object(S.a)(A),e.prev=11,s.s();case 13:if((o=s.n()).done){e.next=19;break}return c=o.value,e.next=17,this.sendAndVerify(c);case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),s.e(e.t0);case 24:return e.prev=24,s.f(),e.finish(24);case 27:this.ready=!0;case 28:case"end":return e.stop()}}),e,this,[[11,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(E.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connected){e.next=2;break}throw Error("No device connected.");case 2:if(this.ready){e.next=4;break}throw Error("Colosseum is not ready. setup() must be called.");case 4:if(0===this.position){e.next=6;break}throw Error("position must be zero, not ".concat(this.position));case 6:return this.startTime=Date.now(),e.next=9,this.resume();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){var e=Object(E.a)(F.a.mark((function e(){var t=this;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connected){e.next=2;break}throw Error("No device connected.");case 2:if(!this.error){e.next=4;break}throw Error("There was an error while running.");case 4:if(!d.a.isNil(this.startTime)){e.next=6;break}throw Error("Call run() instead of resume() at the start.");case 6:if(!this.stopped){e.next=8;break}throw Error("Device was stopped.");case 8:this.paused=!1;case 9:if(this.paused||!(this.position<this.numberOfFractions)||this.error){e.next=16;break}return this.sendAndVerify((n=W[this.position],"<RUN,111,".concat(n,",").concat(n,",").concat(n,">"))).then((function(){return t.callback(t.position)})).catch((function(e){t.error=!0,t.errorCallback(t.position,e)})),this.position++,e.next=14,I(this.interval);case 14:e.next=9;break;case 16:this.position>=this.numberOfFractions&&(this.done=!0,this.doneCallback());case 17:case"end":return e.stop()}var n}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(E.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.paused=!0,this.stopped=!0,e.next=4,this.send("<STOP,111,0.0,0.0,0.0>");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),G=n(100),_=n(57),q=n(1),J=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={show:!1},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(q.jsxs)(G.a,{show:this.state.show,centered:!0,size:"lg",children:[Object(q.jsx)(G.a.Header,{closeButton:!0,children:Object(q.jsxs)(G.a.Title,{children:[Object(q.jsx)(v.a,{icon:_.a}),"Web Serial API Not Found"]})}),Object(q.jsxs)(G.a.Body,{children:[Object(q.jsx)("p",{children:"This web browser does not support the Web Serial API, which is required to use this application. Please use a different browser, or update the current one to a version that supports the Web Serial API."}),Object(q.jsxs)("p",{children:["A list of supported browsers and their versions can be found ",Object(q.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Serial#browser_compatibility",children:"here"}),"."]})]}),Object(q.jsx)(G.a.Footer,{children:Object(q.jsx)(g.a,{children:Object(q.jsx)(w.a,{children:Object(q.jsx)(k.a,{variant:"secondary",onClick:function(){return e.setState({show:!1})},children:"Close"})})})})]})}}]),n}(a.a.Component),H=n(99),K=["0","1","2","3","4","5","6","7","8","9","."],$=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={value:"",unit:null,invalid:null},r.value="",r.unit=null,r.invalid=null,r}return Object(c.a)(n,[{key:"setUnitNumber",value:function(e){if(d.a.isNil(this.props.units)!==d.a.isNil(e.unit)&&!d.a.includes(this.props.units,e.unit))throw Error("unit ".concat(e.unit," not in ").concat(this.props.units));var t=d.a.isFunction(this.props.validator)&&!d.a.isNaN(e.value)?this.props.validator(e.value):null;this.value=e.value,this.unit=e.unit,this.invalid=t,this.setState({value:d.a.isNaN(e.value)?"":e.value.toString(),unit:e.unit,invalid:t})}},{key:"componentDidMount",value:function(){d.a.isNil(this.props.units)||(this.unit=this.props.units[0],this.setState({unit:this.props.units[0]}))}},{key:"onChange",value:function(e,t){d.a.isFunction(this.props.onChange)&&this.props.onChange(e,t)}},{key:"onValueChange",value:function(e){var t=d.a.every(e,(function(e){return d.a.includes(K,e)})),n=d.a.sumBy(e,(function(e){return"."===e}));if(t&&!(n>1)){var r=parseFloat(e),a=d.a.isFunction(this.props.validator)&&!d.a.isNaN(r)?this.props.validator(r):null;d.a.isFunction(this.props.onValueChange)&&this.props.onValueChange(r),this.value=e,this.invalid=a,this.setState({value:e,invalid:a}),this.onChange(r,this.state.unit)}}},{key:"onUnitChange",value:function(e){var t=parseFloat(this.state.value);this.unit=e,this.setState({unit:e}),d.a.isFunction(this.props.onUnitChange)&&this.props.onUnitChange(t),this.onChange(t,e)}},{key:"render",value:function(){var e=this,t=this.props.inputDisabled||this.props.disabled,n=this.props.dropdownDisabled||this.props.disabled;return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(w.a,{className:"col-3",children:Object(q.jsx)(x.a.Label,{className:t&&"text-muted",children:this.props.label})}),Object(q.jsxs)(w.a,{children:[Object(q.jsx)(x.a.Control,{placeholder:this.props.placeholder,value:this.state.value,onChange:function(t){return e.onValueChange(t.target.value)},readOnly:t,isInvalid:!d.a.isNil(this.state.invalid)}),Object(q.jsx)(x.a.Control.Feedback,{type:"invalid",children:this.state.invalid})]}),!d.a.isNil(this.props.units)&&Object(q.jsx)(w.a,{className:"col-3",children:Object(q.jsxs)(H.a,{children:[Object(q.jsx)(H.a.Toggle,{variant:"outline-primary",className:"w-100",disabled:n,children:this.state.unit||"Unit"}),Object(q.jsx)(H.a.Menu,{children:d.a.map(this.props.units,(function(t){return Object(q.jsx)(H.a.Item,{eventKey:t,onSelect:function(t,n){return e.onUnitChange(t)},children:t},t)}))})]})})]})}}]),n}(a.a.Component);$.defaultProps={inputDisabled:!1,dropdownDisabled:!1};var Q=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={value:""},r}return Object(c.a)(n,[{key:"render",value:function(){return Object(q.jsxs)(x.a.Group,{children:[Object(q.jsx)(x.a.Label,{children:this.props.label}),Object(q.jsx)(x.a.Control,{type:"text",placeholder:"",value:this.state.value,readOnly:!0})]})}}]),n}(a.a.Component),X="uL/sec",Y="sec",Z="uL",ee="uL",te=null,ne=function(e,t){return new je(t.value*e.value,ee)},re=function(e,t){return new se(e.value/t.value,te)},ae=function(e,t){return new je(e.value/t.value,Z)},ie=function(e,t){return new de(t.value/e.value,Y)};var se=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(o.a)(this,e);var i,s=Object(S.a)(r);try{for(s.s();!(i=s.n()).done;){var c,u=i.value,l=Object(S.a)(r);try{for(l.s();!(c=l.n()).done;){var h=c.value;if(u!==h&&!d.a.has(a,[u,h]))throw Error("Missing required conversion factor ".concat(u,"->").concat(h))}}catch(m){l.e(m)}finally{l.f()}}}catch(m){s.e(m)}finally{s.f()}if(!d.a.isNumber(t))throw Error("Value must be a number, but got ".concat(t));if(!d.a.isEmpty(r)&&!d.a.includes(r,n))throw Error("Unit must be one of ".concat(d.a.toString(r),", but got ").concat(n));if(d.a.isEmpty(r)&&!d.a.isNil(n))throw Error("Unit must not be provided, but got ".concat(n));this.units=r,this.conversionFactors=a,this.value=t,this.unit=n}return Object(c.a)(e,[{key:"convert",value:function(e){if(d.a.isNil(this.unit)&&d.a.isNil(this.unit)||e===this.unit)return new this.constructor(this.value,this.unit);if(!d.a.includes(this.units,e))throw Error("Unit must be one of ".concat(d.a.toString(this.units),", but got ").concat(e));return new this.constructor(this.conversionFactors[this.unit][e]*this.value,e)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=d.a.isInteger(e)&&e>0?d.a.floor(this.value,e):this.value;return d.a.isNil(this.unit)?"".concat(t):"".concat(t," ").concat(this.unit)}}]),e}(),oe=["uL/sec","uL/min","uL/hr","mL/sec","mL/min","mL/hr"],ce={"uL/sec":{"uL/min":60,"uL/hr":3600,"mL/sec":.001,"mL/min":.06,"mL/hr":3.6},"uL/min":{"uL/sec":1/60,"uL/hr":60,"mL/sec":1/6e4,"mL/min":.001,"mL/hr":.06},"uL/hr":{"uL/sec":1/3600,"uL/min":1/60,"mL/sec":1/36e5,"mL/min":1/6e4,"mL/hr":.001},"mL/sec":{"uL/sec":1e3,"uL/min":6e4,"uL/hr":36e5,"mL/min":60,"mL/hr":3600},"mL/min":{"uL/sec":1e3/60,"uL/min":1e3,"uL/hr":6e4,"mL/sec":1/60,"mL/hr":60},"mL/hr":{"uL/sec":1e3/3600,"uL/min":1e3/60,"uL/hr":1e3,"mL/sec":1/3600,"mL/min":1/60}},ue=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){return Object(o.a)(this,n),t.call(this,e,r,oe,ce)}return n}(se),le=["ms","sec","min","hr"],he={ms:{sec:.001,min:1/6e4,hr:1/36e5},sec:{ms:1e3,min:1/60,hr:1/3600},min:{ms:6e4,sec:60,hr:1/60},hr:{ms:36e5,sec:3600,min:60}},de=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){return Object(o.a)(this,n),t.call(this,e,r,le,he)}return n}(se),me=["0.5 mL","1.0 mL","1.5 mL"],be={"0.5 mL":{"1.0 mL":null,"1.5 mL":null},"1.0 mL":{"0.5 mL":null,"1.5 mL":null},"1.5 mL":{"0.5 mL":null,"1.0 mL":null}},ve=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){return Object(o.a)(this,n),t.call(this,e,r,me,be)}return n}(se),fe=["uL","mL","L"],pe={uL:{mL:.001,L:1e-6},mL:{uL:1e3,L:.001},L:{uL:1e6,mL:1e3}},je=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){return Object(o.a)(this,n),t.call(this,e,r,fe,pe)}return n}(se),Oe=["0.5 mL","1.0 mL","1.5 mL"],xe=["uL/sec","uL/min","uL/hr","mL/sec","mL/min","mL/hr"],ge=["sec","min","hr"],Ne=["uL","mL"],we=["uL","mL","L"],ke=function(e,t,n){return d.a.isNaN(t)?null:new e(t,n)},ye=function(e,t){return ke(ve,e,t)},Le=function(e,t){return ke(ue,e,t)},Se=function(e,t){return ke(de,e,t)},Ce=function(e,t){return ke(je,e,t)},Fe=function(e,t){return ke(se,e,t)},Ee=function(e){return d.a.isInteger(e)?null:"Number must be an integer."},Te=function(e){return e>0?null:"Number must be positive."},Ie="serial"in navigator,Re={0:"Not running",1:"Running",2:"Paused",3:"Stopped",4:"Done",5:"Error"},Ve={0:"danger",1:"info",2:"warning",3:"danger",4:"success",5:"danger"},Pe={totalTime:{volumePerFraction:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ee,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:te,i=e.convert(X),s=t.convert(Y),o=n.convert(Z),c=ne(i,s),u=c.convert(r),l=re(c,o).convert(a);return{totalVolume:u,numberOfFractions:l}},numberOfFractions:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ee,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Z,i=e.convert(X),s=t.convert(Y),o=n.convert(te),c=ne(i,s),u=c.convert(r),l=ae(c,o).convert(a);return{totalVolume:u,volumePerFraction:l}}},totalVolume:{volumePerFraction:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Y,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:te,i=e.convert(X),s=t.convert(ee),o=n.convert(Z),c=ie(i,s).convert(r),u=re(s,o).convert(a);return{totalTime:c,numberOfFractions:u}},numberOfFractions:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Y,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Z,i=e.convert(X),s=t.convert(ee),o=n.convert(te),c=ie(i,s).convert(r),u=ae(s,o).convert(a);return{totalTime:c,volumePerFraction:u}}}},De={totalTime:"totalVolume",totalVolume:"totalTime",volumePerFraction:"numberOfFractions",numberOfFractions:"volumePerFraction"},Ue={"0.5 mL":.5,"1.0 mL":1,"1.5 mL":1.5},Ae=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={timeVolumeRadioSelection:"",volumeNumberRadioSelection:"",connectError:"",connecting:!1,connected:r.props.development&&r.props.connected,status:0,statusError:"",progress:0,devCommand:""},r.colosseum=new B(r.props.development&&r.props.connected),r.monitorInterval=null,r.unitNumbers={numberOfTubes:null,flowRate:null,totalTime:null,totalVolume:null,volumePerFraction:null,numberOfFractions:null},r.notSupportedModal=a.a.createRef(),r.unitNumberInputs={numberOfTubes:a.a.createRef(),flowRate:a.a.createRef(),totalTime:a.a.createRef(),totalVolume:a.a.createRef(),volumePerFraction:a.a.createRef(),numberOfFractions:a.a.createRef()},r.statusInputs={volumeDispensed:a.a.createRef(),timeElapsed:a.a.createRef(),tubeNumber:a.a.createRef()},r.connect=r.connect.bind(Object(O.a)(r)),r.disconnect=r.disconnect.bind(Object(O.a)(r)),r.update=r.update.bind(Object(O.a)(r)),r.validate=r.validate.bind(Object(O.a)(r)),r.run=r.run.bind(Object(O.a)(r)),r.pause=r.pause.bind(Object(O.a)(r)),r.resume=r.resume.bind(Object(O.a)(r)),r.stop=r.stop.bind(Object(O.a)(r)),r.onChange=r.onChange.bind(Object(O.a)(r)),r.monitor=r.monitor.bind(Object(O.a)(r)),r}return Object(c.a)(n,[{key:"connect",value:function(){var e=this;this.setState({connecting:!0}),this.colosseum.connect().then((function(t){return e.setState({connectError:"",connected:!0})})).catch((function(t){return e.setState({connectError:t.toString()})})).finally((function(){return e.setState({connecting:!1})}))}},{key:"disconnect",value:function(){var e=this;this.colosseum.disconnect().then((function(t){return e.setState({connectError:"",connected:!1})})).catch((function(t){return e.setState({connectError:t.toString()})}))}},{key:"send",value:function(e){console.log("send ".concat(e)),this.colosseum.send(e).then((function(t){return console.log("receive ".concat(e))}))}},{key:"monitor",value:function(){if(this.colosseum.done||this.colosseum.error||this.colosseum.stopped)clearInterval(this.monitorInterval);else{var e=new de(Date.now()-this.colosseum.startTime,"ms").convert("sec"),t=this.unitNumbers.totalTime.unit,n=new je(this.unitNumbers.flowRate.convert("uL/sec").value*e.value,"uL"),r=this.unitNumbers.totalVolume.unit;this.statusInputs.volumeDispensed.current.setState({value:n.convert(r).toString(3)}),this.statusInputs.timeElapsed.current.setState({value:e.convert(t).toString(3)})}}},{key:"update",value:function(){var e=this,t=this.state.timeVolumeRadioSelection,n=this.state.volumeNumberRadioSelection,r=De[t],a=De[n],i=this.unitNumbers.flowRate,s=this.unitNumbers[t],o=this.unitNumbers[n],c=this.unitNumberInputs[r].current.unit,u=this.unitNumberInputs[a].current.unit;if(!(d.a.isNil(i)||d.a.isNil(s)||d.a.isNil(o))){var l=Pe[t][n](i,s,o,c,u);d.a.forEach(l,(function(t,n){e.unitNumbers[n]=d.a.isNaN(t.value)?null:t,e.unitNumberInputs[n].current.setUnitNumber(t)}))}}},{key:"validate",value:function(){var e=this,t=d.a.map(this.unitNumbers,(function(t,n){var r=e.unitNumberInputs[n].current;return!!d.a.isNil(r.invalid)&&(!d.a.isNil(t)||(r.setState({invalid:"Input is invalid."}),!1))}));if(!d.a.every(t))return!1;var n=this.unitNumbers.numberOfTubes.value,r=this.unitNumbers.numberOfTubes.unit,a=this.unitNumbers.numberOfFractions.value,i=this.unitNumbers.volumePerFraction.convert("mL").value;return a>n?(this.unitNumberInputs.numberOfTubes.current.setState({invalid:"Number of fractions (".concat(a,") exceeds number of tubes.")}),!1):!(i>Ue[r])||(this.unitNumberInputs.numberOfTubes.current.setState({invalid:"Volume per fraction (".concat(i," mL) exceeds tube size.")}),!1)}},{key:"run",value:function(){var e=this;this.validate()&&this.colosseum.setup(this.unitNumbers.numberOfFractions.value,1e3,(function(t){e.statusInputs.tubeNumber.current.setState({value:t}),e.setState({progress:t/e.unitNumbers.numberOfFractions.value*100})}),(function(t,n){return e.setState({statusError:"Error at position ".concat(t,": ").concat(n.toString()),status:5})}),(function(){return e.setState({status:4})})).then((function(){e.colosseum.run(),e.setState({status:1}),e.monitorInterval=setInterval(e.monitor,100)})).catch((function(t){return e.setState({statusError:"Error during setup: ".concat(t.toString())})}))}},{key:"pause",value:function(){this.colosseum.pause(),this.setState({status:2})}},{key:"resume",value:function(){this.colosseum.resume(),this.setState({status:1})}},{key:"stop",value:function(){this.colosseum.stop(),this.setState({status:3})}},{key:"onChange",value:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.unitNumbers[e]=t(n,r),a&&this.update()}},{key:"componentDidMount",value:function(){Ie||(this.notSupportedModal.current.setState({show:!0}),this.setState({connectError:"Web Serial API not found in current browser"})),this.setState({timeVolumeRadioSelection:"totalTime",volumeNumberRadioSelection:"volumePerFraction"})}},{key:"renderInputs",value:function(e){var t=this,n=this.state.status>0;return Object(q.jsxs)(m.a,{children:[Object(q.jsx)(x.a.Group,{as:g.a,children:Object(q.jsx)($,{ref:this.unitNumberInputs.numberOfTubes,label:"Number of Tubes (excluding tube 0)",placeholder:"# tubes",units:Oe,disabled:n,validator:function(e){return Ee(e)||Te(e)},onChange:function(e,n){return t.onChange("numberOfTubes",ye,e,n,!1)}})}),Object(q.jsx)(x.a.Group,{as:g.a,children:Object(q.jsx)($,{ref:this.unitNumberInputs.flowRate,label:"Flow rate",placeholder:"Flow rate",units:xe,disabled:n,validator:Te,onChange:function(e,n){return t.onChange("flowRate",Le,e,n)}})}),Object(q.jsx)("hr",{}),Object(q.jsxs)(x.a.Group,{as:g.a,children:[Object(q.jsx)(x.a.Check,{type:"radio",name:"timeVolumeRadio",value:"totalTime",checked:"totalTime"===this.state.timeVolumeRadioSelection,disabled:this.state.status>0,onChange:function(e){return t.setState({timeVolumeRadioSelection:e.target.value})}}),Object(q.jsx)($,{ref:this.unitNumberInputs.totalTime,label:"Total time",placeholder:"Total time",units:ge,inputDisabled:"totalTime"!==this.state.timeVolumeRadioSelection,disabled:n,validator:Te,onChange:function(e,n){return t.onChange("totalTime",Se,e,n)}})]}),Object(q.jsxs)(x.a.Group,{as:g.a,children:[Object(q.jsx)(x.a.Check,{type:"radio",name:"timeVolumeRadio",value:"totalVolume",checked:"totalVolume"===this.state.timeVolumeRadioSelection,disabled:n,onChange:function(e){return t.setState({timeVolumeRadioSelection:e.target.value})}}),Object(q.jsx)($,{ref:this.unitNumberInputs.totalVolume,label:"Total volume",placeholder:"Total volume",units:we,inputDisabled:"totalVolume"!==this.state.timeVolumeRadioSelection,disabled:n,validator:Te,onChange:function(e,n){return t.onChange("totalVolume",Ce,e,n)}})]}),Object(q.jsx)("hr",{}),Object(q.jsxs)(x.a.Group,{as:g.a,children:[Object(q.jsx)(x.a.Check,{type:"radio",name:"volumeNumberRadio",value:"volumePerFraction",checked:"volumePerFraction"===this.state.volumeNumberRadioSelection,disabled:n,onChange:function(e){return t.setState({volumeNumberRadioSelection:e.target.value})}}),Object(q.jsx)($,{ref:this.unitNumberInputs.volumePerFraction,label:"Volume per fraction",placeholder:"Volume per fraction",units:Ne,inputDisabled:"volumePerFraction"!==this.state.volumeNumberRadioSelection,disabled:n,validator:Te,onChange:function(e,n){return t.onChange("volumePerFraction",Ce,e,n)}})]}),Object(q.jsxs)(x.a.Group,{as:g.a,children:[Object(q.jsx)(x.a.Check,{type:"radio",name:"volumeNumberRadio",value:"numberOfFractions",checked:"numberOfFractions"===this.state.volumeNumberRadioSelection,disabled:n,onChange:function(e){return t.setState({volumeNumberRadioSelection:e.target.value})}}),Object(q.jsx)($,{ref:this.unitNumberInputs.numberOfFractions,label:"Number of fractions",placeholder:"Number of fractions",inputDisabled:"numberOfFractions"!==this.state.volumeNumberRadioSelection,disabled:n,validator:function(e){return Ee(e)||Te(e)},onChange:function(e,n){return t.onChange("numberOfFractions",Fe,e,n)}})]}),Object(q.jsx)("hr",{}),Object(q.jsx)(N.a,{variant:"warning",children:"Please ensure the dispenser arm is centered on the first tube by rotating the tube bed. Tube numbering starts at zero."}),Object(q.jsxs)(g.a,{className:"p-2",children:[Object(q.jsx)(w.a,{children:Object(q.jsx)(k.a,{variant:"primary",className:"btn-block",size:"sm",disabled:!e||!d.a.includes([0,2],this.state.status),onClick:this.run,children:"Run"})}),Object(q.jsx)(w.a,{children:Object(q.jsx)(k.a,{variant:"primary",className:"btn-block",size:"sm",disabled:1!==this.state.status,onClick:this.pause,children:"Pause"})}),Object(q.jsx)(w.a,{children:Object(q.jsx)(k.a,{variant:"primary",className:"btn-block",size:"sm",disabled:2!==this.state.status,onClick:this.resume,children:"Resume"})}),Object(q.jsx)(w.a,{children:Object(q.jsx)(k.a,{variant:"primary",className:"btn-block",size:"sm",disabled:!d.a.includes([1,2],this.state.status),onClick:this.stop,children:"Stop"})})]})]})}},{key:"renderStatus",value:function(e){return Object(q.jsxs)(m.a,{children:[Object(q.jsx)(g.a,{className:"justify-content-center",children:Object(q.jsx)("h4",{children:"Status"})}),Object(q.jsx)(g.a,{className:"justify-content-center mb-1",children:Object(q.jsx)(y.a,{variant:e?"success":"danger",children:e?"Connected":"Disconnnected"})}),Object(q.jsx)(g.a,{className:"justify-content-center mb-1",children:Object(q.jsx)(y.a,{variant:Ve[this.state.status],children:Re[this.state.status]})}),Object(q.jsx)(L.a,{className:"mb-1",variant:Ve[this.state.status],now:this.state.progress,animated:this.state.progress<100,label:"".concat(d.a.floor(this.state.progress),"%")}),Object(q.jsx)("hr",{}),Object(q.jsx)(Q,{ref:this.statusInputs.volumeDispensed,label:"Volume Dispensed"}),Object(q.jsx)(Q,{ref:this.statusInputs.timeElapsed,label:"Time Elapsed"}),Object(q.jsx)(Q,{ref:this.statusInputs.tubeNumber,label:"Tube Number"}),Object(q.jsx)(g.a,{children:Object(q.jsx)(w.a,{style:{color:"red"},children:this.state.statusError})})]})}},{key:"renderOther",value:function(){return Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(J,{ref:this.notSupportedModal})})}},{key:"render",value:function(){var e=this,t=this.state.connected;return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)(m.a,{children:[this.props.development&&Object(q.jsxs)(N.a,{variant:"warning",children:[Object(q.jsx)("p",{children:"DEVELOPMENT MODE"}),Object(q.jsx)(x.a.Group,{children:Object(q.jsxs)(g.a,{children:[Object(q.jsx)(w.a,{className:"col-7",children:Object(q.jsx)(x.a.Control,{value:this.state.devCommand,onChange:function(t){return e.setState({devCommand:t.target.value})},placeholder:"Command"})}),Object(q.jsx)(w.a,{children:Object(q.jsx)(k.a,{onClick:function(){return e.send(e.state.devCommand)},disabled:!t,children:"Send"})})]})})]}),Object(q.jsxs)(g.a,{className:"mb-5",children:[Object(q.jsx)(w.a,{className:"col-3",children:Object(q.jsx)(k.a,{className:"btn-block",variant:"primary",onClick:t?this.disconnect:this.connect,disabled:!Ie||this.state.connecting,children:this.state.connecting?"Connecting...":t?"Disconnect":"Connect"})}),Object(q.jsx)(w.a,{style:{color:"red"},children:this.state.connectError})]}),Object(q.jsxs)(g.a,{children:[Object(q.jsx)(w.a,{className:"col-9 mr-4",children:Object(q.jsx)(g.a,{children:this.renderInputs(t)})}),Object(q.jsx)(w.a,{children:Object(q.jsx)(g.a,{children:this.renderStatus(t)})})]})]}),this.renderOther()]})}}]),n}(a.a.Component);Ae.defaultProps={development:!1,connected:!1};var We=j.a.parse(window.location.search),Me=d.a.has(We,"dev"),ze=d.a.has(We,"connected"),Be=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){document.title="Colosseum UI"}},{key:"render",value:function(){return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(m.a,{className:"mb-4",children:Object(q.jsxs)(b.a,{bg:"dark",variant:"dark",children:[Object(q.jsx)(b.a.Brand,{children:"Colosseum UI"}),Object(q.jsxs)(b.a.Collapse,{className:"justify-content-end",children:[Object(q.jsxs)(b.a.Text,{className:"mr-3",children:[Object(q.jsx)(v.a,{icon:f.a,className:"mr-1"}),Object(q.jsx)("a",{href:"https://github.com/pachterlab/colosseum",children:"pachterlab/colosseum"})]}),Object(q.jsxs)(b.a.Text,{children:["doi: ",Object(q.jsx)("a",{href:"https://doi.org/10.1101/2021.01.27.428538",children:"10.1101/2021.01.27.428538"})]})]})]})}),Object(q.jsx)(m.a,{className:"w-75",children:Object(q.jsx)(Ae,{development:Me,connected:ze})})]})}}]),n}(a.a.Component),Ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,104)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),i(e),s(e)}))},_e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function qe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(Object(q.jsx)(a.a.StrictMode,{children:Object(q.jsx)(Be,{})}),document.getElementById("root")),Ge(),function(e){if("serviceWorker"in navigator){if(new URL("/colosseum",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/colosseum","/service-worker.js");_e?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):qe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):qe(t,e)}))}}()}},[[90,1,2]]]);
//# sourceMappingURL=main.f83333a1.chunk.js.map